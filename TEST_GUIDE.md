# 출석체크 항목 변경 테스트 가이드

## 변경 사항 요약
- 기존: 학년 출석, 부서 출석
- 변경: **교리출석**, **미사출석**, **부서출석** (3가지)

## 테스트 전 준비사항

### 1. 데이터베이스 마이그레이션 적용

```bash
cd attendance-app/backend
npx prisma migrate deploy
```

또는 개발 환경에서는:

```bash
npx prisma migrate dev
```

기존 'grade' 타입 출석 기록은 자동으로 'doctrine'으로 변경됩니다.

### 2. Prisma Client 재생성

```bash
cd attendance-app/backend
npx prisma generate
```

### 3. 백엔드 서버 실행

```bash
cd attendance-app/backend
npm run dev
```

서버가 `http://localhost:3000`에서 실행됩니다.

### 4. 프론트엔드 서버 실행

새 터미널에서:

```bash
cd attendance-app/frontend
npm run dev
```

프론트엔드가 `http://localhost:5173`에서 실행됩니다.

## 테스트 체크리스트

### ✅ 1. 관리자 로그인
- [ ] `http://localhost:5173/admin/login` 접속
- [ ] 관리자 비밀번호 입력 후 로그인 성공

### ✅ 2. 네비게이션 메뉴 확인
- [ ] 관리자 대시보드에서 다음 메뉴가 보이는지 확인:
  - 교리출석 (파란색)
  - 미사출석 (주황색)
  - 부서출석 (보라색)
  - 학생 관리
  - 통계

### ✅ 3. 교리출석 테스트
- [ ] "교리출석" 탭 클릭
- [ ] 학년 선택 드롭다운에서 "학년을 선택하세요" 표시 확인
- [ ] 학년 선택 전에는 학생 목록이 보이지 않음
- [ ] 학년 선택 전에는 안내 메시지 표시: "⚠️ 교리출석은 학년별로 체크합니다. 학년을 선택해주세요."
- [ ] 학년 선택 (예: "1학년")
- [ ] 해당 학년 학생 목록이 표시됨
- [ ] 날짜 선택 (2026년 일요일)
- [ ] 학생별 출석/결석 체크 가능
- [ ] "전원 출석" 버튼 작동
- [ ] "저장" 버튼 클릭
- [ ] 저장 성공 메시지 확인: "교리출석이 저장되었습니다. (N명, 출석자 달란트 +1)"
- [ ] 출석한 학생의 달란트가 +1 증가했는지 확인

### ✅ 4. 미사출석 테스트
- [ ] "미사출석" 탭 클릭
- [ ] 학년 선택 드롭다운에서 "학년을 선택하세요" 표시 확인
- [ ] 학년 선택 전에는 학생 목록이 보이지 않음
- [ ] 학년 선택 전에는 안내 메시지 표시: "⚠️ 미사출석은 학년별로 체크합니다. 학년을 선택해주세요."
- [ ] 학년 선택 (예: "2학년")
- [ ] 해당 학년 학생 목록이 표시됨
- [ ] 날짜 선택 (2026년 일요일)
- [ ] 학생별 출석/결석 체크 가능
- [ ] "전원 출석" 버튼 작동
- [ ] "저장" 버튼 클릭
- [ ] 저장 성공 메시지 확인: "미사출석이 저장되었습니다. (N명, 출석자 달란트 +1)"
- [ ] 출석한 학생의 달란트가 +1 증가했는지 확인

### ✅ 5. 부서출석 테스트
- [ ] "부서출석" 탭 클릭
- [ ] 부서 선택 드롭다운 표시 확인
- [ ] 부서 선택 (예: "전례부")
- [ ] 해당 부서 학생 목록이 표시됨
- [ ] 날짜 선택 (2026년 일요일)
- [ ] 학생별 출석/결석 체크 가능
- [ ] "저장" 버튼 클릭
- [ ] 저장 성공 메시지 확인

### ✅ 6. 중복 체크 방지 테스트
- [ ] 같은 학생, 같은 날짜에 교리출석 체크
- [ ] 같은 학생, 같은 날짜에 미사출석 체크 (별도로 가능해야 함)
- [ ] 같은 학생, 같은 날짜에 부서출석 체크 (별도로 가능해야 함)
- [ ] 각 출석 타입별로 독립적으로 달란트 지급 확인

### ✅ 7. 출석 기록 수정 테스트
- [ ] 이미 체크한 출석 기록의 상태 변경 (출석 → 결석)
- [ ] 달란트가 정상적으로 조정되는지 확인
- [ ] 결석 → 출석으로 변경 시 달란트 지급 확인

### ✅ 8. 통계 확인
- [ ] "통계" 탭 클릭
- [ ] 교리출석과 미사출석 데이터가 통계에 반영되는지 확인
- [ ] 엑셀 내보내기에서 출석 타입이 올바르게 표시되는지 확인

### ✅ 9. 학생 조회 화면 테스트
- [ ] 메인 화면에서 학생 이름으로 검색
- [ ] 학생의 출석 기록에서 교리출석, 미사출석, 부서출석이 구분되어 표시되는지 확인

## 예상 결과

1. **교리출석과 미사출석은 학년별로만 체크 가능**
   - 학년 선택이 필수
   - 학년 선택 전에는 학생 목록이 표시되지 않음

2. **각 출석 타입은 독립적으로 관리**
   - 같은 학생이 같은 날 교리출석, 미사출석, 부서출석을 모두 체크할 수 있음
   - 각 출석마다 달란트 1개씩 지급 (최대 3개까지 가능)

3. **UI 개선**
   - 학년 선택 필수 표시 (*)
   - 학년 미선택 시 안내 메시지
   - 색상 구분: 교리(파란색), 미사(주황색), 부서(보라색)

## 문제 발생 시

1. **마이그레이션 오류**
   - 데이터베이스 연결 확인
   - `.env` 파일의 `DATABASE_URL` 확인

2. **컴포넌트 오류**
   - 브라우저 콘솔 확인
   - 네트워크 탭에서 API 요청 확인

3. **타입 오류**
   - `npx prisma generate` 재실행
   - 프론트엔드와 백엔드 재시작

## 추가 확인사항

- [ ] 기존 'grade' 타입 출석 기록이 'doctrine'으로 변경되었는지 확인
- [ ] 데이터베이스의 `attendance` 테이블에서 `type` 컬럼 값 확인
- [ ] 통계 대시보드에서 교리/미사 출석 데이터가 올바르게 집계되는지 확인
